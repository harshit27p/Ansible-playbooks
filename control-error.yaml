---
 - name: Task Failure Exercise
   hosts: servera
   vars:
     web_package: http
     db_package: mariadb-server
     db_service: mariadb
   tasks:
     - name: Attempt to set up a webserver
       block:
           - name: Install {{ web_package }} package
             dnf:
                 name: "{{ web_package }}"
                 state: present
             ignore_errors: true

       rescue:
           - name: install {{ db_package }} package
             dnf:
                 name: "{{ db_package }}"
                 state: present

       always:
           - name: start {{ db_service }} service
             service:
                 name: "{{ db_service }}"
                 state: started
